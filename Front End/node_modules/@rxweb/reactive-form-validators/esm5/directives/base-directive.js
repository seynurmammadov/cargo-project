import * as tslib_1 from "tslib";
import { Input } from "@angular/core";
import { defaultContainer } from "../core/defaultContainer";
import { OBJECT_PROPERTY, PROPERTY } from "../const";
import { ApplicationUtil } from "../util/app-util";
import { TEMPLATE_VALIDATION_CONFIG } from '../const/app.const';
var BaseDirective = /** @class */ (function () {
    function BaseDirective() {
    }
    BaseDirective.prototype.applyValidations = function (controls, model) {
        var _this = this;
        if (model === void 0) { model = null; }
        if (this.model) {
            var modelConfig_1 = defaultContainer.get(model || this.model.constructor);
            if (modelConfig_1) {
                modelConfig_1.properties.forEach(function (property) {
                    if (controls[property.name]) {
                        switch (property.propertyType) {
                            case PROPERTY:
                                _this.setValidatorConfig(controls[property.name], modelConfig_1, property);
                                break;
                            case OBJECT_PROPERTY:
                                _this.applyValidations(controls[property.name].controls, property.entity);
                                break;
                        }
                    }
                });
            }
        }
    };
    BaseDirective.prototype.setValidatorConfig = function (control, modelConfig, property) {
        var annotations = modelConfig.propertyAnnotations.filter(function (t) { return t.propertyName == property.name; });
        annotations.forEach(function (annotation) {
            if (!control[TEMPLATE_VALIDATION_CONFIG])
                control[TEMPLATE_VALIDATION_CONFIG] = {};
            ApplicationUtil.configureControl(control, annotation.config ? annotation.config : "", annotation.annotationType);
        });
    };
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], BaseDirective.prototype, "model", void 0);
    return BaseDirective;
}());
export { BaseDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Acnh3ZWIvcmVhY3RpdmUtZm9ybS12YWxpZGF0b3JzLyIsInNvdXJjZXMiOlsiZGlyZWN0aXZlcy9iYXNlLWRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV0QyxPQUFPLEVBQUMsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQTtBQUMxRCxPQUFPLEVBQUcsZUFBZSxFQUFFLFFBQVEsRUFBQyxNQUFNLFVBQVUsQ0FBQTtBQUVwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbkQsT0FBTyxFQUFFLDBCQUEwQixFQUFHLE1BQU0sb0JBQW9CLENBQUE7QUFDaEU7SUFBQTtJQStCQSxDQUFDO0lBNUJHLHdDQUFnQixHQUFoQixVQUFpQixRQUFZLEVBQUMsS0FBZ0I7UUFBOUMsaUJBa0JDO1FBbEI2QixzQkFBQSxFQUFBLFlBQWdCO1FBQzFDLElBQUcsSUFBSSxDQUFDLEtBQUssRUFBQztZQUNWLElBQUksYUFBVyxHQUFHLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUN4RSxJQUFHLGFBQVcsRUFBQztnQkFDWCxhQUFXLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFBLFFBQVE7b0JBQ25DLElBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBQzt3QkFDM0IsUUFBTyxRQUFRLENBQUMsWUFBWSxFQUFFOzRCQUMxQixLQUFLLFFBQVE7Z0NBQ1QsS0FBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUMsYUFBVyxFQUFDLFFBQVEsQ0FBQyxDQUFDO2dDQUMxRSxNQUFNOzRCQUNOLEtBQUssZUFBZTtnQ0FDaEIsS0FBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQ0FDNUUsTUFBTTt5QkFDVDtxQkFDSjtnQkFDRCxDQUFDLENBQUMsQ0FBQTthQUNMO1NBQ0o7SUFDTCxDQUFDO0lBRU8sMENBQWtCLEdBQTFCLFVBQTJCLE9BQXVCLEVBQUMsV0FBNkIsRUFBQyxRQUFxQjtRQUNsRyxJQUFJLFdBQVcsR0FBRSxXQUFXLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLFVBQUEsQ0FBQyxJQUFHLE9BQUEsQ0FBQyxDQUFDLFlBQVksSUFBSSxRQUFRLENBQUMsSUFBSSxFQUEvQixDQUErQixDQUFDLENBQUM7UUFDN0YsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFBLFVBQVU7WUFDMUIsSUFBRyxDQUFDLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztnQkFDdkMsT0FBTyxDQUFDLDBCQUEwQixDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ3pDLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQTtRQUNwSCxDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUE3QlE7UUFBUixLQUFLLEVBQUU7O2dEQUFXO0lBOEJ2QixvQkFBQztDQUFBLEFBL0JELElBK0JDO1NBL0JxQixhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wgfSBmcm9tIFwiQGFuZ3VsYXIvZm9ybXNcIlxyXG5pbXBvcnQge2RlZmF1bHRDb250YWluZXIgfSBmcm9tIFwiLi4vY29yZS9kZWZhdWx0Q29udGFpbmVyXCJcclxuaW1wb3J0IHsgIE9CSkVDVF9QUk9QRVJUWSwgUFJPUEVSVFl9IGZyb20gXCIuLi9jb25zdFwiXHJcbmltcG9ydCB7ICBJbnN0YW5jZUNvbnRhaW5lciwgUHJvcGVydHlJbmZvIH0gZnJvbSAnLi4vY29yZS92YWxpZGF0b3IuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgQXBwbGljYXRpb25VdGlsIH0gZnJvbSBcIi4uL3V0aWwvYXBwLXV0aWxcIjtcclxuaW1wb3J0IHsgVEVNUExBVEVfVkFMSURBVElPTl9DT05GSUcgIH0gZnJvbSAnLi4vY29uc3QvYXBwLmNvbnN0J1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZURpcmVjdGl2ZSB7XHJcbiAgICBASW5wdXQoKSBtb2RlbDphbnk7XHJcbiAgICBcclxuICAgIGFwcGx5VmFsaWRhdGlvbnMoY29udHJvbHM6YW55LG1vZGVsOmFueSA9IG51bGwpe1xyXG4gICAgICAgIGlmKHRoaXMubW9kZWwpe1xyXG4gICAgICAgICAgICBsZXQgbW9kZWxDb25maWcgPSBkZWZhdWx0Q29udGFpbmVyLmdldChtb2RlbCB8fCB0aGlzLm1vZGVsLmNvbnN0cnVjdG9yKTtcclxuICAgICAgICAgICAgaWYobW9kZWxDb25maWcpe1xyXG4gICAgICAgICAgICAgICAgbW9kZWxDb25maWcucHJvcGVydGllcy5mb3JFYWNoKHByb3BlcnR5ID0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNvbnRyb2xzW3Byb3BlcnR5Lm5hbWVdKXtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2gocHJvcGVydHkucHJvcGVydHlUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgUFJPUEVSVFk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFZhbGlkYXRvckNvbmZpZyhjb250cm9sc1twcm9wZXJ0eS5uYW1lXSxtb2RlbENvbmZpZyxwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE9CSkVDVF9QUk9QRVJUWTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlWYWxpZGF0aW9ucyhjb250cm9sc1twcm9wZXJ0eS5uYW1lXS5jb250cm9scyxwcm9wZXJ0eS5lbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0VmFsaWRhdG9yQ29uZmlnKGNvbnRyb2w6QWJzdHJhY3RDb250cm9sLG1vZGVsQ29uZmlnOkluc3RhbmNlQ29udGFpbmVyLHByb3BlcnR5OlByb3BlcnR5SW5mbyl7XHJcbiAgICAgICAgbGV0IGFubm90YXRpb25zPSBtb2RlbENvbmZpZy5wcm9wZXJ0eUFubm90YXRpb25zLmZpbHRlcih0PT4gdC5wcm9wZXJ0eU5hbWUgPT0gcHJvcGVydHkubmFtZSk7XHJcbiAgICAgICAgYW5ub3RhdGlvbnMuZm9yRWFjaChhbm5vdGF0aW9uID0+e1xyXG4gICAgICAgICAgICBpZighY29udHJvbFtURU1QTEFURV9WQUxJREFUSU9OX0NPTkZJR10pXHJcbiAgICAgICAgICAgIGNvbnRyb2xbVEVNUExBVEVfVkFMSURBVElPTl9DT05GSUddID0ge307XHJcbiAgICAgICAgICAgIEFwcGxpY2F0aW9uVXRpbC5jb25maWd1cmVDb250cm9sKGNvbnRyb2wsIGFubm90YXRpb24uY29uZmlnID8gYW5ub3RhdGlvbi5jb25maWcgOiBcIlwiLCBhbm5vdGF0aW9uLmFubm90YXRpb25UeXBlKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuIl19