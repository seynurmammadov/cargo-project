import { DateProvider } from './date-provider';
import { ApplicationUtil } from './app-util';
import { ReactiveFormConfig } from "./reactive-form-config";
function isNotBlank(value) {
    return (value !== undefined && value !== null && value !== "");
}
function trim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.trim();
    return value;
}
;
function ltrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/^\s+/g, '');
    return value;
}
function rtrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/\s+$/g, '');
    return value;
}
function blacklist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp('[$' + chars + ']+', 'g'), '');
    return value;
}
;
function stripLow(value, keepNewLines) {
    var chars = keepNewLines === true ? '\x00-\x09\x0B\x0C\x0E-\x1F\x7F' : '\x00-\x1F\x7F';
    return blacklist(value, chars);
}
function toBoolean(value, strict) {
    if (isNotBlank(value)) {
        if (strict) {
            return value === '1' || value === 'true';
        }
        return value !== '0' && value !== 'false' && value !== '';
    }
    return value;
}
function toFloat(value) {
    if (isNotBlank(value)) {
        var decimalSymbol = '.';
        if (ReactiveFormConfig && ReactiveFormConfig.number) {
            decimalSymbol = (ReactiveFormConfig.json && ReactiveFormConfig.json.allowDecimalSymbol) ? ReactiveFormConfig.json.allowDecimalSymbol : ReactiveFormConfig.number.decimalSymbol;
        }
        if (decimalSymbol == ',' && typeof value == "string")
            value = value.replace(',', '.');
        if (ApplicationUtil.isNumeric(value))
            return parseFloat(value);
    }
    return null;
}
function toDouble(value) {
    return toFloat(value);
}
function toInt(value, radix) {
    if (isNotBlank(value))
        if (ApplicationUtil.isNumeric(value))
            return parseInt(value, radix || 10);
    return null;
}
function toString(value, radix) {
    if (isNotBlank(value))
        return String(value);
    return value;
}
function whitelist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp("[^" + chars + "]+", 'g'), '');
    return value;
}
function toDate(value, config) {
    var dateProvider = new DateProvider();
    if (isNotBlank(value))
        if (typeof value === "string" && dateProvider.isValid(value, config)) {
            value = dateProvider.getDate(value);
            return value;
        }
    return null;
}
function escape(value) {
    if (isNotBlank(value))
        return (value.replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#x27;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2F;')
            .replace(/\\/g, '&#x5C;')
            .replace(/`/g, '&#96;'));
    return value;
}
function prefix(value, text) {
    if (isNotBlank(value))
        return "" + text + value;
    return value;
}
function suffix(value, text) {
    if (isNotBlank(value))
        return "" + value + text;
    return value;
}
function sanitize(value, config) {
    return config.custom(value);
}
export var SANITIZERS = {
    trim: trim,
    ltrim: ltrim,
    rtrim: rtrim,
    blacklist: blacklist,
    stripLow: stripLow,
    toBoolean: toBoolean,
    toDouble: toDouble,
    toFloat: toFloat,
    toInt: toInt,
    'toString': toString,
    whitelist: whitelist,
    toDate: toDate,
    escape: escape,
    prefix: prefix,
    suffix: suffix,
    sanitize: sanitize
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FuaXRpemVycy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJ1dGlsL3Nhbml0aXplcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFBO0FBQzlDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFN0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFNUQsU0FBUyxVQUFVLENBQUMsS0FBVTtJQUMxQixPQUFPLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBQ0QsU0FBUyxJQUFJLENBQUMsS0FBVTtJQUNwQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzVCLE9BQU8sS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFBQSxDQUFDO0FBRUYsU0FBUyxLQUFLLENBQUMsS0FBVTtJQUNyQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDMUMsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEtBQVU7SUFDckIsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pCLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUTtZQUN6QixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLE9BQU8sS0FBSyxDQUFDO0FBQ2pC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LEtBQVUsRUFBRSxJQUFZO0lBQ3BDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQztRQUNqQixPQUFPLEtBQUcsS0FBSyxHQUFHLElBQU0sQ0FBQztJQUM3QixPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDO0FBRUQsU0FBUyxRQUFRLENBQUMsS0FBVSxFQUFFLE1BQXNCO0lBQ2hELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUMvQixDQUFDO0FBRUQsTUFBTSxDQUFDLElBQU0sVUFBVSxHQUFnQztJQUVuRCxJQUFJLEVBQUUsSUFBSTtJQUVWLEtBQUssRUFBRSxLQUFLO0lBRVosS0FBSyxFQUFFLEtBQUs7SUFFWixTQUFTLEVBQUUsU0FBUztJQUVwQixRQUFRLEVBQUUsUUFBUTtJQUVsQixTQUFTLEVBQUUsU0FBUztJQUVwQixRQUFRLEVBQUUsUUFBUTtJQUVsQixPQUFPLEVBQUUsT0FBTztJQUVoQixLQUFLLEVBQUUsS0FBSztJQUVaLFVBQVUsRUFBRSxRQUFRO0lBRXBCLFNBQVMsRUFBRSxTQUFTO0lBRXBCLE1BQU0sRUFBRSxNQUFNO0lBRWQsTUFBTSxFQUFFLE1BQU07SUFFZCxNQUFNLEVBQUUsTUFBTTtJQUVkLE1BQU0sRUFBRSxNQUFNO0lBRWQsUUFBUSxFQUFFLFFBQVE7Q0FDckIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERhdGVQcm92aWRlciB9IGZyb20gJy4vZGF0ZS1wcm92aWRlcidcclxuaW1wb3J0IHsgQXBwbGljYXRpb25VdGlsIH0gZnJvbSAnLi9hcHAtdXRpbCc7XHJcbmltcG9ydCB7IFNhbml0aXplQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL2NvbmZpZy9zYW5pdGl6ZS1jb25maWcnXHJcbmltcG9ydCB7IFJlYWN0aXZlRm9ybUNvbmZpZyB9IGZyb20gXCIuL3JlYWN0aXZlLWZvcm0tY29uZmlnXCI7XHJcblxyXG5mdW5jdGlvbiBpc05vdEJsYW5rKHZhbHVlOiBhbnkpIHtcclxuICAgIHJldHVybiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gXCJcIik7XHJcbn1cclxuZnVuY3Rpb24gdHJpbSh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRyaW0oKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGx0cmltKHZhbHVlOiBhbnkpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXlxccysvZywgJycpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBydHJpbSh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL1xccyskL2csICcnKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gYmxhY2tsaXN0KHZhbHVlOiBhbnksIGNoYXJzKSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UobmV3IFJlZ0V4cCgnWyQnICsgY2hhcnMgKyAnXSsnLCAnZycpLCAnJyk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBzdHJpcExvdyh2YWx1ZTogYW55LCBrZWVwTmV3TGluZXM6IGJvb2xlYW4pIHtcclxuICAgIGxldCBjaGFyczogU3RyaW5nID0ga2VlcE5ld0xpbmVzID09PSB0cnVlID8gJ1xceDAwLVxceDA5XFx4MEJcXHgwQ1xceDBFLVxceDFGXFx4N0YnIDogJ1xceDAwLVxceDFGXFx4N0YnO1xyXG4gICAgcmV0dXJuIGJsYWNrbGlzdCh2YWx1ZSwgY2hhcnMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsdWU6IGFueSwgc3RyaWN0OiBib29sZWFuKSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpIHtcclxuICAgICAgICBpZiAoc3RyaWN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gJzEnIHx8IHZhbHVlID09PSAndHJ1ZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZSAhPT0gJzAnICYmIHZhbHVlICE9PSAnZmFsc2UnICYmIHZhbHVlICE9PSAnJztcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9GbG9hdCh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpIHtcclxuICAgICAgICB2YXIgZGVjaW1hbFN5bWJvbCA9ICcuJztcclxuICAgICAgICBpZiAoUmVhY3RpdmVGb3JtQ29uZmlnICYmIFJlYWN0aXZlRm9ybUNvbmZpZy5udW1iZXIpIHtcclxuICAgICAgICAgICAgZGVjaW1hbFN5bWJvbCA9IChSZWFjdGl2ZUZvcm1Db25maWcuanNvbiAmJiBSZWFjdGl2ZUZvcm1Db25maWcuanNvbi5hbGxvd0RlY2ltYWxTeW1ib2wpID8gUmVhY3RpdmVGb3JtQ29uZmlnLmpzb24uYWxsb3dEZWNpbWFsU3ltYm9sIDogUmVhY3RpdmVGb3JtQ29uZmlnLm51bWJlci5kZWNpbWFsU3ltYm9sO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRlY2ltYWxTeW1ib2wgPT0gJywnICYmIHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCcsJywgJy4nKTtcclxuICAgICAgICAgICAgaWYgKEFwcGxpY2F0aW9uVXRpbC5pc051bWVyaWModmFsdWUpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5mdW5jdGlvbiB0b0RvdWJsZSh2YWx1ZTogYW55KSB7XHJcbiAgICByZXR1cm4gdG9GbG9hdCh2YWx1ZSlcclxufVxyXG5cclxuZnVuY3Rpb24gdG9JbnQodmFsdWU6IGFueSwgcmFkaXg6IG51bWJlcikge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmIChBcHBsaWNhdGlvblV0aWwuaXNOdW1lcmljKHZhbHVlKSlcclxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLCByYWRpeCB8fCAxMCk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9TdHJpbmcodmFsdWU6IGFueSwgcmFkaXg6IG51bWJlcikge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiBTdHJpbmcodmFsdWUpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcbmZ1bmN0aW9uIHdoaXRlbGlzdCh2YWx1ZTogYW55LCBjaGFyczogc3RyaW5nKSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UobmV3IFJlZ0V4cChgW14ke2NoYXJzfV0rYCwgJ2cnKSwgJycpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b0RhdGUodmFsdWU6IGFueSwgY29uZmlnOiBhbnkpIHtcclxuICAgIHZhciBkYXRlUHJvdmlkZXIgPSBuZXcgRGF0ZVByb3ZpZGVyKCk7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBkYXRlUHJvdmlkZXIuaXNWYWxpZCh2YWx1ZSwgY29uZmlnKSkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IGRhdGVQcm92aWRlci5nZXREYXRlKHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG5mdW5jdGlvbiBlc2NhcGUodmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiAodmFsdWUucmVwbGFjZSgvJi9nLCAnJmFtcDsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgJyZxdW90OycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csICcmI3gyNzsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvPC9nLCAnJmx0OycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8+L2csICcmZ3Q7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnJiN4MkY7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJyYjeDVDOycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9gL2csICcmIzk2OycpKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJlZml4KHZhbHVlOiBhbnksIHRleHQ6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiBgJHt0ZXh0fSR7dmFsdWV9YDtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3VmZml4KHZhbHVlOiBhbnksIHRleHQ6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiBgJHt2YWx1ZX0ke3RleHR9YDtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemUodmFsdWU6IGFueSwgY29uZmlnOiBTYW5pdGl6ZUNvbmZpZykge1xyXG4gICAgcmV0dXJuIGNvbmZpZy5jdXN0b20odmFsdWUpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBTQU5JVElaRVJTOiB7IFtrZXk6IHN0cmluZ106IEZ1bmN0aW9uIH0gPSB7XHJcblxyXG4gICAgdHJpbTogdHJpbSxcclxuXHJcbiAgICBsdHJpbTogbHRyaW0sXHJcblxyXG4gICAgcnRyaW06IHJ0cmltLFxyXG5cclxuICAgIGJsYWNrbGlzdDogYmxhY2tsaXN0LFxyXG5cclxuICAgIHN0cmlwTG93OiBzdHJpcExvdyxcclxuXHJcbiAgICB0b0Jvb2xlYW46IHRvQm9vbGVhbixcclxuXHJcbiAgICB0b0RvdWJsZTogdG9Eb3VibGUsXHJcblxyXG4gICAgdG9GbG9hdDogdG9GbG9hdCxcclxuXHJcbiAgICB0b0ludDogdG9JbnQsXHJcblxyXG4gICAgJ3RvU3RyaW5nJzogdG9TdHJpbmcsXHJcblxyXG4gICAgd2hpdGVsaXN0OiB3aGl0ZWxpc3QsXHJcblxyXG4gICAgdG9EYXRlOiB0b0RhdGUsXHJcblxyXG4gICAgZXNjYXBlOiBlc2NhcGUsXHJcblxyXG4gICAgcHJlZml4OiBwcmVmaXgsXHJcblxyXG4gICAgc3VmZml4OiBzdWZmaXgsXHJcblxyXG4gICAgc2FuaXRpemU6IHNhbml0aXplXHJcbn0iXX0=