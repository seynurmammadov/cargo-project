import { DateProvider } from './date-provider';
import { ApplicationUtil } from './app-util';
import { ReactiveFormConfig } from "./reactive-form-config";
function isNotBlank(value) {
    return (value !== undefined && value !== null && value !== "");
}
function trim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.trim();
    return value;
}
;
function ltrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/^\s+/g, '');
    return value;
}
function rtrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/\s+$/g, '');
    return value;
}
function blacklist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp('[$' + chars + ']+', 'g'), '');
    return value;
}
;
function stripLow(value, keepNewLines) {
    let chars = keepNewLines === true ? '\x00-\x09\x0B\x0C\x0E-\x1F\x7F' : '\x00-\x1F\x7F';
    return blacklist(value, chars);
}
function toBoolean(value, strict) {
    if (isNotBlank(value)) {
        if (strict) {
            return value === '1' || value === 'true';
        }
        return value !== '0' && value !== 'false' && value !== '';
    }
    return value;
}
function toFloat(value) {
    if (isNotBlank(value)) {
        var decimalSymbol = '.';
        if (ReactiveFormConfig && ReactiveFormConfig.number) {
            decimalSymbol = (ReactiveFormConfig.json && ReactiveFormConfig.json.allowDecimalSymbol) ? ReactiveFormConfig.json.allowDecimalSymbol : ReactiveFormConfig.number.decimalSymbol;
        }
        if (decimalSymbol == ',' && typeof value == "string")
            value = value.replace(',', '.');
        if (ApplicationUtil.isNumeric(value))
            return parseFloat(value);
    }
    return null;
}
function toDouble(value) {
    return toFloat(value);
}
function toInt(value, radix) {
    if (isNotBlank(value))
        if (ApplicationUtil.isNumeric(value))
            return parseInt(value, radix || 10);
    return null;
}
function toString(value, radix) {
    if (isNotBlank(value))
        return String(value);
    return value;
}
function whitelist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp(`[^${chars}]+`, 'g'), '');
    return value;
}
function toDate(value, config) {
    var dateProvider = new DateProvider();
    if (isNotBlank(value))
        if (typeof value === "string" && dateProvider.isValid(value, config)) {
            value = dateProvider.getDate(value);
            return value;
        }
    return null;
}
function escape(value) {
    if (isNotBlank(value))
        return (value.replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#x27;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2F;')
            .replace(/\\/g, '&#x5C;')
            .replace(/`/g, '&#96;'));
    return value;
}
function prefix(value, text) {
    if (isNotBlank(value))
        return `${text}${value}`;
    return value;
}
function suffix(value, text) {
    if (isNotBlank(value))
        return `${value}${text}`;
    return value;
}
function sanitize(value, config) {
    return config.custom(value);
}
export const SANITIZERS = {
    trim: trim,
    ltrim: ltrim,
    rtrim: rtrim,
    blacklist: blacklist,
    stripLow: stripLow,
    toBoolean: toBoolean,
    toDouble: toDouble,
    toFloat: toFloat,
    toInt: toInt,
    'toString': toString,
    whitelist: whitelist,
    toDate: toDate,
    escape: escape,
    prefix: prefix,
    suffix: suffix,
    sanitize: sanitize
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FuaXRpemVycy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJ1dGlsL3Nhbml0aXplcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFBO0FBQzlDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFN0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFNUQsU0FBUyxVQUFVLENBQUMsS0FBVTtJQUMxQixPQUFPLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBQ0QsU0FBUyxJQUFJLENBQUMsS0FBVTtJQUNwQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzVCLE9BQU8sS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFBQSxDQUFDO0FBRUYsU0FBUyxLQUFLLENBQUMsS0FBVTtJQUNyQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDMUMsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEtBQVU7SUFDckIsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pCLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUTtZQUN6QixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLE9BQU8sS0FBSyxDQUFDO0FBQ2pC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LENBQUMsS0FBVSxFQUFFLElBQVk7SUFDcEMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pCLE9BQU8sR0FBRyxLQUFLLEdBQUcsSUFBSSxFQUFFLENBQUM7SUFDN0IsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQztBQUVELFNBQVMsUUFBUSxDQUFDLEtBQVUsRUFBRSxNQUFzQjtJQUNoRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDL0IsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBZ0M7SUFFbkQsSUFBSSxFQUFFLElBQUk7SUFFVixLQUFLLEVBQUUsS0FBSztJQUVaLEtBQUssRUFBRSxLQUFLO0lBRVosU0FBUyxFQUFFLFNBQVM7SUFFcEIsUUFBUSxFQUFFLFFBQVE7SUFFbEIsU0FBUyxFQUFFLFNBQVM7SUFFcEIsUUFBUSxFQUFFLFFBQVE7SUFFbEIsT0FBTyxFQUFFLE9BQU87SUFFaEIsS0FBSyxFQUFFLEtBQUs7SUFFWixVQUFVLEVBQUUsUUFBUTtJQUVwQixTQUFTLEVBQUUsU0FBUztJQUVwQixNQUFNLEVBQUUsTUFBTTtJQUVkLE1BQU0sRUFBRSxNQUFNO0lBRWQsTUFBTSxFQUFFLE1BQU07SUFFZCxNQUFNLEVBQUUsTUFBTTtJQUVkLFFBQVEsRUFBRSxRQUFRO0NBQ3JCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEYXRlUHJvdmlkZXIgfSBmcm9tICcuL2RhdGUtcHJvdmlkZXInXHJcbmltcG9ydCB7IEFwcGxpY2F0aW9uVXRpbCB9IGZyb20gJy4vYXBwLXV0aWwnO1xyXG5pbXBvcnQgeyBTYW5pdGl6ZUNvbmZpZyB9IGZyb20gJy4uL21vZGVscy9jb25maWcvc2FuaXRpemUtY29uZmlnJ1xyXG5pbXBvcnQgeyBSZWFjdGl2ZUZvcm1Db25maWcgfSBmcm9tIFwiLi9yZWFjdGl2ZS1mb3JtLWNvbmZpZ1wiO1xyXG5cclxuZnVuY3Rpb24gaXNOb3RCbGFuayh2YWx1ZTogYW55KSB7XHJcbiAgICByZXR1cm4gKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IFwiXCIpO1xyXG59XHJcbmZ1bmN0aW9uIHRyaW0odmFsdWU6IGFueSkge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS50cmltKCk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBsdHJpbSh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL15cXHMrL2csICcnKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcnRyaW0odmFsdWU6IGFueSkge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKC9cXHMrJC9nLCAnJyk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGJsYWNrbGlzdCh2YWx1ZTogYW55LCBjaGFycykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoJ1skJyArIGNoYXJzICsgJ10rJywgJ2cnKSwgJycpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gc3RyaXBMb3codmFsdWU6IGFueSwga2VlcE5ld0xpbmVzOiBib29sZWFuKSB7XHJcbiAgICBsZXQgY2hhcnM6IFN0cmluZyA9IGtlZXBOZXdMaW5lcyA9PT0gdHJ1ZSA/ICdcXHgwMC1cXHgwOVxceDBCXFx4MENcXHgwRS1cXHgxRlxceDdGJyA6ICdcXHgwMC1cXHgxRlxceDdGJztcclxuICAgIHJldHVybiBibGFja2xpc3QodmFsdWUsIGNoYXJzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9Cb29sZWFuKHZhbHVlOiBhbnksIHN0cmljdDogYm9vbGVhbikge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKSB7XHJcbiAgICAgICAgaWYgKHN0cmljdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgPT09ICcxJyB8fCB2YWx1ZSA9PT0gJ3RydWUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsdWUgIT09ICcwJyAmJiB2YWx1ZSAhPT0gJ2ZhbHNlJyAmJiB2YWx1ZSAhPT0gJyc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvRmxvYXQodmFsdWU6IGFueSkge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKSB7XHJcbiAgICAgICAgdmFyIGRlY2ltYWxTeW1ib2wgPSAnLic7XHJcbiAgICAgICAgaWYgKFJlYWN0aXZlRm9ybUNvbmZpZyAmJiBSZWFjdGl2ZUZvcm1Db25maWcubnVtYmVyKSB7XHJcbiAgICAgICAgICAgIGRlY2ltYWxTeW1ib2wgPSAoUmVhY3RpdmVGb3JtQ29uZmlnLmpzb24gJiYgUmVhY3RpdmVGb3JtQ29uZmlnLmpzb24uYWxsb3dEZWNpbWFsU3ltYm9sKSA/IFJlYWN0aXZlRm9ybUNvbmZpZy5qc29uLmFsbG93RGVjaW1hbFN5bWJvbCA6IFJlYWN0aXZlRm9ybUNvbmZpZy5udW1iZXIuZGVjaW1hbFN5bWJvbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkZWNpbWFsU3ltYm9sID09ICcsJyAmJiB0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgnLCcsICcuJyk7XHJcbiAgICAgICAgICAgIGlmIChBcHBsaWNhdGlvblV0aWwuaXNOdW1lcmljKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuZnVuY3Rpb24gdG9Eb3VibGUodmFsdWU6IGFueSkge1xyXG4gICAgcmV0dXJuIHRvRmxvYXQodmFsdWUpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvSW50KHZhbHVlOiBhbnksIHJhZGl4OiBudW1iZXIpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAoQXBwbGljYXRpb25VdGlsLmlzTnVtZXJpYyh2YWx1ZSkpXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh2YWx1ZSwgcmFkaXggfHwgMTApO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbHVlOiBhbnksIHJhZGl4OiBudW1iZXIpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5mdW5jdGlvbiB3aGl0ZWxpc3QodmFsdWU6IGFueSwgY2hhcnM6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoYFteJHtjaGFyc31dK2AsICdnJyksICcnKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9EYXRlKHZhbHVlOiBhbnksIGNvbmZpZzogYW55KSB7XHJcbiAgICB2YXIgZGF0ZVByb3ZpZGVyID0gbmV3IERhdGVQcm92aWRlcigpO1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgZGF0ZVByb3ZpZGVyLmlzVmFsaWQodmFsdWUsIGNvbmZpZykpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSBkYXRlUHJvdmlkZXIuZ2V0RGF0ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZnVuY3Rpb24gZXNjYXBlKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICByZXR1cm4gKHZhbHVlLnJlcGxhY2UoLyYvZywgJyZhbXA7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvJy9nLCAnJiN4Mjc7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvPi9nLCAnJmd0OycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXC8vZywgJyYjeDJGOycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXFxcL2csICcmI3g1QzsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvYC9nLCAnJiM5NjsnKSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHByZWZpeCh2YWx1ZTogYW55LCB0ZXh0OiBzdHJpbmcpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICByZXR1cm4gYCR7dGV4dH0ke3ZhbHVlfWA7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1ZmZpeCh2YWx1ZTogYW55LCB0ZXh0OiBzdHJpbmcpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICByZXR1cm4gYCR7dmFsdWV9JHt0ZXh0fWA7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhbml0aXplKHZhbHVlOiBhbnksIGNvbmZpZzogU2FuaXRpemVDb25maWcpIHtcclxuICAgIHJldHVybiBjb25maWcuY3VzdG9tKHZhbHVlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgU0FOSVRJWkVSUzogeyBba2V5OiBzdHJpbmddOiBGdW5jdGlvbiB9ID0ge1xyXG5cclxuICAgIHRyaW06IHRyaW0sXHJcblxyXG4gICAgbHRyaW06IGx0cmltLFxyXG5cclxuICAgIHJ0cmltOiBydHJpbSxcclxuXHJcbiAgICBibGFja2xpc3Q6IGJsYWNrbGlzdCxcclxuXHJcbiAgICBzdHJpcExvdzogc3RyaXBMb3csXHJcblxyXG4gICAgdG9Cb29sZWFuOiB0b0Jvb2xlYW4sXHJcblxyXG4gICAgdG9Eb3VibGU6IHRvRG91YmxlLFxyXG5cclxuICAgIHRvRmxvYXQ6IHRvRmxvYXQsXHJcblxyXG4gICAgdG9JbnQ6IHRvSW50LFxyXG5cclxuICAgICd0b1N0cmluZyc6IHRvU3RyaW5nLFxyXG5cclxuICAgIHdoaXRlbGlzdDogd2hpdGVsaXN0LFxyXG5cclxuICAgIHRvRGF0ZTogdG9EYXRlLFxyXG5cclxuICAgIGVzY2FwZTogZXNjYXBlLFxyXG5cclxuICAgIHByZWZpeDogcHJlZml4LFxyXG5cclxuICAgIHN1ZmZpeDogc3VmZml4LFxyXG5cclxuICAgIHNhbml0aXplOiBzYW5pdGl6ZVxyXG59Il19